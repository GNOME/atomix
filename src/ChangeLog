2001-11-20  Jens Finke <jens@triq.net>

	* .cvsignore: Added level-convert and pf-test.

2001-11-20  Jens Finke <jens@triq.net>

	* Checked huge page in. There are three major tile types now:
	ATOM, WALL and FLOOR. Each tile has a base image which may have
	overlay and underlay images too. Level descriptions consist of
	three parts now: environment, scenario and goal. These changes
	affects nearly all files.

	* level-convert.c: New file, converts levels from the 0.4.3 format
	to the new format.

	* pf-test.c: New file, checks functions of the playfield data
	type..
	
	* Makefile.am (noinst_PROGRAMS): Added programs level-convert and
	pf-test.
	
2001-11-15  Jens Finke <jens@triq.net>

	* goal-view.c (create_small_item): Scale the pixbuf with
	gdk_pixbuf_scale_simple.

	* main.c (create_canvas_widget): Create an aa canvas.
	
2001-11-14  Jens Finke <jens@triq.net>

	* board.c (board_render): Use playfield_get_n_cols when iterating
	over the columns.

	* goal-view.c (clear_view): Check if item_group is != NULL.

	* level-manager.c (create_level_sequence): Added dummy handler for
	'text' tag.
	(load_level): Added dummy handler for 'text' tag. Print just a
	message about unknown tag not a warning.

	* playfield.c (playfield_new_from_xml): Added dummy handler for
	'text' tag.

	* theme-manager.c (load_theme),
	(handle_link_image_node),
	(handle_base_image_node): Added dummy handler for 'text' tag.

	* tile.c (tile_new_from_xml): Added dummy handler for 'text' tag.
	
2001-11-14  Jens Finke <jens@triq.net>

	* level-private.h: Forgot to add this. So here it is. 

2001-11-14  Jens Finke <jens@triq.net>

	* board.c (board_render): Check for tile == NULL.

	* goal.c (destroy_hash_value): Use g_slist_free to free the list.

	* level-manager.c (level_manager_init_levels): Look in
	~/.atomix/levels/ for 'sequence' file for now.
	(search_level_in_dir): Skip the dirs '.' and '..' correctly as
	well as the 'sequence' file. Use g_build_filename with NULL as
	last argument.
	(level_manager_get_next_level): Number of levels > 0 isn't an
	assertion anymore, but will be checked with a normal if statement.
	Get the filename from the hash table not the sequence list.
	(load_level): For a 'goal' node skip all other child nodes than
	'playfield'.

	* main.c (game_user_quits): Use gtk_widget_destroy to free the
	dialog. Check user response against GTK_RESPONSE_YES.
	(game_finished): Use gtk_widget_destroy to free the dialog.

	* theme.c (get_theme_image_pixbuf): Ref every pixbuf before
	returning.
	
2001-11-14  Jens Finke <jens@triq.net>

	* Makefile.am: Added playfield test program 'pf-test'.
	(atomix_SOURCES): Added goal-view.[ch], removed callbacks.[ch],
	preferences.[ch].
	(libatomix_a_SOURCES): Added level-manager.[ch]
	
	* board.[ch]: Reworked this, so that it works with the other new
	classes.

	* goal-view.[ch]: New files.

	* goal.[ch]: Reworked this. It is now a seperate class with all
	the gui stuff moved to goal-view.[ch].

	* callbacks.[ch]: Removed files.

	* canvas_helper.[ch]: Removed the non ref functions and removed
	the function name suffix _ref from the rest.

	* level-manager.[ch] (level_manager_is_last_level): New function.
	(level_manager_get_next_level): Use the filname from the successor
	of the search result.

	* level.c (level_get_playfield): Ref the outgoing playfield reference.
	(level_get_goal): dito.

	* level.h (level_get_type): Moved here from level-private.h.

	* main.[ch]: Reworked this and removed some of the functionality
	for now. It's more clean and structured now. Contains all the
	callbacks too.

	* theme-manager.c (handle_base_image_node): Ignore non bimage xml
	nodes.
	(handle_link_image_node): Ignore non limage xml nodes.

	* theme.h (theme_get_type): Moved here from theme-private.h.

	* theme.c (theme_finalize): Don't iterate through the hash table
	to free objects.
	(theme_new): Provide destroy method for hash data with
	g_hash_table_new_full.

	* util.c: Commented out all the functionality for now. We havn't a
	statusbar yet.

	* global.h: Removed file.
	
2001-11-13  Jens Finke <jens@triq.net>

	* level-manager.[ch]: New files.

	* level.[ch]: Reworked these files, moved a lot of the general
	level handling to level-manager.[ch].

	* playfield.[ch] (playfield_get_type): Fixed class type.
	(playfield_new_from_xml): New function.

	* theme-manager.c (theme_manager_init): Provide destroy functions
	for hash table key and value objects.
	(destroy_theme_item): Removed.
	(load_theme): Create theme after xml document creation.

	* theme.c (theme_get_type): Fixed class type.

	* tile.[ch] (tile_new_from_xml): New function.

2001-11-12  Jens Finke <jens@triq.net>

	* goal.[ch]: Reworked these files.

	* main.[ch] (get_app): Added this function again temporary.

	* playfield.[ch] (playfield_get_n_rows),
	(playfield_get_n_cols): New functions.

	* tile.[ch]: Added link_id_value attribute, which defines the
	attached links as one single integer value.
	(tile_init), 
	(tile_copy), 
	(tile_add_link), 
	(tile_remove_link),
	(tile_remove_all_links): Update link_id_value.
	(tile_is_equal): New function, compares two tiles.
	(tile_get_hash_value): New function, returns a single value, which
	identifies a tile uniquely.
	(tile_print): Made the output better fitting into playfield_print.

2001-11-12  Jens Finke <jens@triq.net>

	* playfield.[ch]: Rewrote this, uses glib object system now.

2001-11-12  Jens Finke <jens@triq.net>

	* theme-manager.c (theme_manager_init), (search_themes_in_dir),
	(load_theme): Removed unneeded variables.
	(string_to_tile_link): Initialize link with TILE_LINK_LAST.

	* theme.[ch] (theme_get_name), (theme_get_animstep): New functions.

2001-11-12  Jens Finke <jens@triq.net>

	* board.c: Adaptions to make it work with the new tile.[ch].
	(create_obstacle), (create_moveable), (create_item):
	Removed deprecated functions.
	(create_tile): New function, which uses the new theme interface.

	* callbacks.c (atomix_exit): Use g_object_unref to free the theme.

	* main.[ch]: Adaptions to the new theme[-manager] interface.

	* tile.c (tile_has_link): Return always false on TILE_LINK_LAST.
	
